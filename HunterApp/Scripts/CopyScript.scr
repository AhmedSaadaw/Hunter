{"Type":null,"Title":"CopyScript","Script_Code":"//CSharp code\r\nusing System.Globalization;\r\n\r\nstring ConName = GetValueStr(\"Script.MapControllerName\");\r\nstring ConNameICC2 = GetValueStr(\"Script.MapControllerNameICC2\");\r\nstring ConNameACC1 = GetValueStr(\"Script.MapControllerNameACC1\");// Creat this tag an assign it at the Controller struc\r\n double buffer,Pumpbuffer,Senbuffer,Pmvbuffer,BlockStnbuffer,Monthbuffer;\r\nstring bufferstr;\r\n//--------------------------------------------------------------------------------------------------- Controller Info -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.ControllerInfoCopyEnable\")==1)\r\n {\r\n \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFieldControllerGlobals_UnixTimeYear_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetControllerTimeAndDate_UnixTimeYear_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFieldControllerGlobals_UnixTimeMonth_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetControllerTimeAndDate_UnixTimeMonth_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFieldControllerGlobals_UnixTimeDay_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetControllerTimeAndDate_UnixTimeDay_Command\",buffer);\r\n\tif (GetValueNum(\"Botton.TimeFormat\")==0)\r\n\t{\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFieldControllerGlobals_UnixTimeHour_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetControllerTimeAndDate_UnixTimeHour_Command\",buffer);\r\n\t}\r\n\telse\r\n\t{\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFieldControllerGlobals_UnixTimeHour_Status\") % 12;\r\n  Stream.Tag.SetValueNum(ConName+\".SetControllerTimeAndDate_12Hour_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".Report_ControlInfo_meridian\");\r\n  Stream.Tag.SetValueNum(ConName+\".ControlInfo_meridian\",buffer);\t\r\n\t}\t\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFieldControllerGlobals_UnixTimeMinute_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetControllerTimeAndDate_UnixTimeMinute_Command\",buffer);\r\n\r\n\tSetValueNum(\"Script.ControllerInfoCopyEnable\",0);\r\n }\r\n//--------------------------------------------------------------------------------------------------- Seasonal Adjust -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.SeasonalAdjustCopyEnable\")==1)\r\n {\r\n  \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportSeasonalAdjustValues_GblSeasAdj_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetSeasonalAdjustValues_GblSeasAdj_Command\",buffer);\r\n\tfor (int i=1 ; i<=12 ; i++)\r\n\t{\r\n\t string index = i.ToString();\r\n\t Monthbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportSeasonalAdjustValues_Month\"+index+\"SeasAdj_Status\");\r\n   Stream.Tag.SetValueNum(ConName+\".SetSeasonalAdjustValues_Month\"+index+\"SeasAdj_Command\",Monthbuffer);\r\n\t}\r\n\r\n\tSetValueNum(\"Script.SeasonalAdjustCopyEnable\",0);\r\n }\r\n//--------------------------------------------------------------------------------------------------- Block -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.BlockSettingCopyEnable\")==1)\r\n {\r\n  \r\n\t buffer = Stream.Tag.GetValueNum(ConName+\".ReportBlockParameters_BlockNumber_Command\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetBlockParameters_BlockNumber_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportBlockParameters_CycleTime_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetBlockParameters_CycleTime_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportBlockParameters_SoakTime_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetBlockParameters_SoakTime_Command\",buffer);\r\n\tfor (int i=1 ; i<=8 ; i++)\r\n\t{\r\n\t string index = i.ToString();\r\n\t BlockStnbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportBlockParameters_BlockStn\"+index+\"_Status\");\r\n   Stream.Tag.SetValueNum(ConName+\".SetBlockParameters_BlockStn\"+index+\"_Command\",BlockStnbuffer);\r\n\t}\r\n\r\n\tSetValueNum(\"Script.BlockSettingCopyEnable\",0);\r\n }\r\n//--------------------------------------------------------------------------------------------------- FlowZone Paramter -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.FlowZoneParamtersCopyEnable\")==1)\r\n {\r\n\t int min , sec;\r\n\t \r\n  for (int j=1; j<=6;j++)\r\n {\r\n\t\tstring FZ = j.ToString();\r\n\t\tbuffer = (Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_FlowTarget_Status_FZ\"+FZ)/10)*GetValueNum(\"Botton.UnitScaleGPM\");\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlow_FlowTarget_Command_FZ\"+FZ,buffer);\r\n\t\tbuffer = (Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_MaxFlowLimit_Status_FZ\"+FZ)/10)*GetValueNum(\"Botton.UnitScaleGPM\");\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlow_MaxFlowLimit_Command_FZ\"+FZ,buffer);\r\n\t\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_MaxPOverflow_Status_FZ\"+FZ);\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlowZoneParameters_MaxPOverflow_Command_FZ\"+FZ,buffer);\r\n\t\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_MaxPUnderflow_Status_FZ\"+FZ);\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlowZoneParameters_MaxPUnderflow_Command_FZ\"+FZ,buffer);\r\n\t\tbuffer = (Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_UnschedFlowLimit_Status_FZ\"+FZ)/10)*GetValueNum(\"Botton.UnitScaleGPM\");\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlow_UnschedFlowLimit_Command_FZ\"+FZ,buffer);\r\n\t\tbuffer = (Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_MonthlyBudget_Status_FZ\"+FZ)/10)*GetValueNum(\"Botton.UnitScaleG\");\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlow_MonthlyBudget_Command_FZ\"+FZ,buffer);\r\n\t\tbuffer = (Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_ManualAllowance_Status_FZ\"+FZ)/10)*GetValueNum(\"Botton.UnitScaleGPM\");\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlow_ManualAllowance_Command_FZ\"+FZ,buffer);\r\n\t\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_AlarmSetDelay_Status_FZ\"+FZ);\r\n\t\t min= (int)buffer/60;\r\n\t \tsec=(int)buffer%60;\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlow_AlarmSetDelay_Command_Min_FZ\"+FZ,min);\r\n\t  Stream.Tag.SetValueNum(ConName+\".SetFlow_AlarmSetDelay_Command_Sec_FZ1\"+FZ,sec);\r\n\t\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_AlarmClearDelay_Status_FZ\"+FZ);\r\n\t   min= (int)buffer/3600;\r\n\t \tsec=((int)buffer%3600)/60;\r\n\t  Stream.Tag.SetValueNum(ConName+\".SetFlow_AlarmClearDelay_Command_Min_FZ\"+FZ,min);\r\n\t  Stream.Tag.SetValueNum(ConName+\".SetFlow_AlarmClearDelay_Command_Sec_FZ\"+FZ,sec);\r\n\t\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_FlowMonEnable_Status_FZ\"+FZ);\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlowZoneParameters_FlowMonEnable_Command_FZ\"+FZ,buffer);\r\n\t\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportFlowZoneParameters_FlowMgrEnable_Status_FZ\"+FZ);\r\n  \tStream.Tag.SetValueNum(ConName+\".SetFlowZoneParameters_FlowMgrEnable_Command_FZ\"+FZ,buffer);\r\n\t\tfor (int i=1 ; i<=6 ; i++)\r\n\t\t{\r\n\t \tstring index = i.ToString();\r\n\t \tSenbuffer = (int)Stream.Tag.GetValueNum(ConName+\".Report_FlowSenMap_Status_FZ\"+FZ+\"_\"+ index);\r\n   \tStream.Tag.SetValueNum(ConName+\".SetFlow_FlowSenMap_Command_FZ\"+FZ+\"_\"+index,Senbuffer);\r\n\t\t Pmvbuffer = (int)Stream.Tag.GetValueNum(ConName+\".Report_PmvMap_Status_FZ\"+FZ+\"_\"+ index);\r\n   \tStream.Tag.SetValueNum(ConName+\".SetFlow_PmvMap_Command_FZ\"+FZ+\"_\"+index,Pmvbuffer);\r\n\t\t}\r\n\r\n }\r\n\t\tSetValueNum(\"Script.FlowZoneParamtersCopyEnable\",0);\r\n }\r\n//--------------------------------------------------------------------------------------------------- Station Paramter -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.StationParamterCopyEnable\")==1)\r\n {\r\n\t int min , hour;\r\n\t \r\n \tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportStationParameters_StationNumber_Command\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetStationParameters_StationNumber_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportStationParameters_CycleTime_Status\");\r\n\t hour= (int)buffer/60;\r\n\t min=(int)buffer%60;\r\n  Stream.Tag.SetValueNum(ConName+\".SetStationParameters_CycleTime_Hour_Command\",hour);\r\n\tStream.Tag.SetValueNum(ConName+\".SetStationParameters_CycleTime_Min_Command\",min); \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportStationParameters_SoakTime_Status\");\r\n\t hour= (int)buffer/60;\r\n\t min=(int)buffer%60;\r\n  Stream.Tag.SetValueNum(ConName+\".SetStationParameters_SoakTime_Hour_Command\",hour);\r\n\tStream.Tag.SetValueNum(ConName+\".SetStationParameters_SoakTime_Min_Command\",min); \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportStationParameters_FlowZone_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetStationParameters_FlowZone_Command\",buffer);\r\n  if (GetValueNum(ConName+\".ReportStationParameters_LearnedFlow_Status\")==65535)\r\n\t{\r\n  //Stream.Tag.SetValueNum(ConName+\".SetStationParameters_LearnedFlow_Command\",6553.5);\r\n\t\tStream.Tag.SetValueNum(ConName+\".SetStationParameters_LearnedFlow_United\",6553.5);\r\n\t}\r\n else\r\n\t{\r\n  buffer = (Stream.Tag.GetValueNum(ConName+\".ReportStationParameters_LearnedFlow_Status\")/10) * (GetValueNum(\"Botton.UnitScaleGPM\"));\r\n\t\t//File.AppendAllText(@\"C:\\Users\\ahmed\\OneDrive - streamcontrols.com\\Desktop\\Work\\Hunter\\HunterApp\\H360\\flowpram.txt\",\"without :\"+buffer.ToString()+Environment.NewLine);\r\n\t\tbuffer=  Math.Round(buffer, 1);\r\n\t\t//File.AppendAllText(@\"C:\\Users\\ahmed\\OneDrive - streamcontrols.com\\Desktop\\Work\\Hunter\\HunterApp\\H360\\flowpram.txt\",buffer.ToString()+Environment.NewLine);\r\n  Stream.Tag.SetValueNum(ConName+\".SetStationParameters_LearnedFlow_United\",buffer);\r\n\t}\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportStationParameters_FlowDelay_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetStationParameters_FlowDelay_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportStationParameters_FlowPriority_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetStationParameters_FlowPriority_Command\",buffer);\r\n\tfor (int i=1 ; i<=6 ; i++)\r\n\t{\r\n\t string index = i.ToString();\r\n\t Pumpbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportStationParameters_Pump\"+index+\"Usage_Status\");\r\n   Stream.Tag.SetValueNum(ConName+\".SetStationParameters_Pump\"+index+\"Usage_Command\",Pumpbuffer);\r\n\t}\r\n\r\n\tSetValueNum(\"Script.StationParamterCopyEnable\",0);\r\n }\r\n//--------------------------------------------------------------------------------------------------- Solar Sync -----------------------------------------------------------------------------------------\r\n//ACC2\r\nif (GetValueNum(\"Script.SolaeSyncCopyEnable\")==1)\r\n {\r\n \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportSolarSyncEtData_Region_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetSolarSyncSettings_GeoRegion_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportSolarSyncEtData_Adjust_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetSolarSyncSettings_Adjust_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportSolarSyncEtData_DelayDays_Status\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetSolarSyncSettings_DlyDays_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportSolarSyncEtData_DelayAdjust_\");\r\n  Stream.Tag.SetValueNum(ConName+\".SetSolarSyncSettings_DlyAdjust_Command\",buffer);\r\n\t\r\n\tSetValueNum(\"Script.SolaeSyncCopyEnable\",0);\r\n }\r\n\r\n\r\n//--------------------------------------------------------------------------------------------------- Flow Zone Set -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Botton.FlowZoneEnableScript\")==1)\r\n{\r\nfor(int i=1 ; i< 7; i++)\r\n{\r\n\tdouble Target = (GetValueNum(ConName+\".SetFlow_FlowTarget_Command_FZ\"+i.ToString())*10)/GetValueNum(\"Botton.UnitScaleGPM\");\r\n\tSetValueNum(ConName+\".SetFlowZoneParameters_FlowTarget_Command_FZ\"+i.ToString(),Target);\r\n\r\n\tdouble MaxLimit=(GetValueNum(ConName+\".SetFlow_MaxFlowLimit_Command_FZ\"+i.ToString())*10)/GetValueNum(\"Botton.UnitScaleGPM\");\r\n\tSetValueNum(ConName+\".SetFlowZoneParameters_MaxFlowLimit_Command_FZ\"+i.ToString(),MaxLimit);\r\n\r\n\tdouble UnschedLimit=(GetValueNum(ConName+\".SetFlow_UnschedFlowLimit_Command_FZ\"+i.ToString())*10)/GetValueNum(\"Botton.UnitScaleGPM\");\r\n\tSetValueNum(ConName+\".SetFlowZoneParameters_UnschedFlowLimit_Command_FZ\"+i.ToString(),UnschedLimit);\r\n\r\n\tdouble MonthlyBudget=(GetValueNum(ConName+\".SetFlow_MonthlyBudget_Command_FZ\"+i.ToString())*10)/GetValueNum(\"Botton.UnitScaleG\");\r\n\tSetValueNum(ConName+\".SetFlowZoneParameters_MonthlyBudget_Command_FZ\"+i.ToString(),MonthlyBudget);\r\n\r\n\tdouble ManualAllowance=(GetValueNum(ConName+\".SetFlow_ManualAllowance_Command_FZ\"+i.ToString())*10)/GetValueNum(\"Botton.UnitScaleGPM\");\r\n\tSetValueNum(ConName+\".SetFlowZoneParameters_ManualAllowance_Command_FZ\"+i.ToString(),ManualAllowance);\r\n\r\n\t//double AlarmSetDelay=GetValueNum(ConName+\".SetFlow_AlarmSetDelay_Command_FZ\"+i.ToString())*60;\r\n\t//SetValueNum(ConName+\".SetFlowZoneParameters_AlarmSetDelay_Command_FZ\"+i.ToString(),AlarmSetDelay);\r\n\r\n\t//double AlarmClearDelay=GetValueNum(ConName+\".SetFlow_AlarmClearDelay_Command_FZ\"+i.ToString())*60;\r\n\t//SetValueNum(ConName+\".SetFlowZoneParameters_AlarmClearDelay_Command_FZ\"+i.ToString(),AlarmClearDelay);\r\n\r\n\r\n\r\n\tdouble FlowSenMap = ( GetValueNum(ConName+\".SetFlow_FlowSenMap_Command_FZ\"+i.ToString()+\"_1\")+ (GetValueNum(ConName+\".SetFlow_FlowSenMap_Command_FZ\"+i.ToString()+\"_2\")*2)+ (GetValueNum(ConName+\".SetFlow_FlowSenMap_Command_FZ\"+i.ToString()+\"_3\")*4)+(GetValueNum(ConName+\".SetFlow_FlowSenMap_Command_FZ\"+i.ToString()+\"_4\")*8)+ (GetValueNum(ConName+\".SetFlow_FlowSenMap_Command_FZ\"+i.ToString()+\"_5\")*16)+(GetValueNum(ConName+\".SetFlow_FlowSenMap_Command_FZ\"+i.ToString()+\"_6\")*32));\r\n\tSetValueNum(ConName+\".SetFlowZoneParameters_FlowSenMap_Command_FZ\"+i.ToString(),FlowSenMap);\r\n\r\n\r\ndouble PmvMap = ( GetValueNum(ConName+\".SetFlow_PmvMap_Command_FZ\"+i.ToString()+\"_1\")+ (GetValueNum(ConName+\".SetFlow_PmvMap_Command_FZ\"+i.ToString()+\"_2\")*2)+ (GetValueNum(ConName+\".SetFlow_PmvMap_Command_FZ\"+i.ToString()+\"_3\")*4)+(GetValueNum(ConName+\".SetFlow_PmvMap_Command_FZ\"+i.ToString()+\"_4\")*8)+ (GetValueNum(ConName+\".SetFlow_PmvMap_Command_FZ\"+i.ToString()+\"_5\")*16)+(GetValueNum(ConName+\".SSetFlow_PmvMap_Command_FZ\"+i.ToString()+\"_6\")*32));\r\n\tSetValueNum(ConName+\".SetFlowZoneParameters_PmvMap_Command_FZ\"+i.ToString(),PmvMap);\r\n\t\r\n//-------------------------------------------Set Alarm Delay---------------------\r\n\t/*\r\n\tint SetMin,SetHour,MainMin;\r\n SetMin=(int) GetValueNum(ConName+\".SetFlow_AlarmSetDelay_Command_Min_FZ\"+i.ToString());\r\n SetHour=(int) GetValueNum(ConName+\".SetFlow_AlarmSetDelay_Command_Sec_FZ\"+i.ToString());\r\n MainMin  = (int)SetMin + ((int)SetHour * 60 );\r\n SetValueNum(ConName+\".SetFlowZoneParameters_AlarmSetDelay_Command_F\"+i.ToString(),MainMin); \t\r\n\t\r\n*/\r\n}\r\n}\r\n\r\n\r\n//--------------------------------------------------------------------------------------------------- irrigation Schedule Edit -----------------------------------------------------------------------------------------\r\n\r\n//Copy Data From Program GET to Program SET\r\n\r\n if (GetValueNum(\"Script.Schedule_Edit_Copy\")==1)\r\n{\r\n int buffer;\r\n int bufferMin,bufferHour;\r\n int bufferType,bufferID,bufferTime;\r\n int bufferBitMap,bufferBitMap1,bufferBitMap2;\r\n int Shours=0,Sminutes=0,Ehours=0,Eminutes=0;\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_ProgramNumber_Command\");\r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_ProgramNumber_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_StackMode_Status\");\t\r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_StackMode_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_ScheduleType_Status\");\r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_ScheduleType_Command\",buffer);\r\n/*\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_DOWDays_Status\");\t\r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_DOWDays_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_OddEvenDays_Status\");\t\r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_OddEvenDays_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_IntervalDays_Status\");\r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_IntervalDays_Command\",buffer);\r\n*/\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_IntLength_Status\");\r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_IntLength_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_IntNextWater_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_IntNextWater_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_StartType_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_StartType_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_SeasAdjSource_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_SeasAdjSource_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_SeasonalAdjust_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_SeasonalAdjust_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_IgnoreCalDaysOff_Status\");\r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_IgnoreCalDaysOff_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_STEStartTime_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_STEStartTime_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_STEEndTime_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_STEEndTime_Command\",buffer);\r\n \r\n\r\n string StimeString =GetValueStr(ConName+\".Report_NWWStart_String\");\r\n \r\n if (StimeString != null)\r\n {\r\n  string[] timeComponents = StimeString.Split(':');\r\n  Shours = int.Parse(timeComponents[0]);\r\n  Sminutes = int.Parse(timeComponents[1]);\r\n  //int seconds = int.Parse(timeComponents[2]);\r\n }\r\n string EtimeString =GetValueStr(ConName+\".Report_NWWEnd_String\");\r\n if (EtimeString != null)\r\n {\r\n  string[] EtimeComponents = EtimeString.Split(':');\r\n   Ehours = int.Parse(EtimeComponents[0]);\r\n   Eminutes = int.Parse(EtimeComponents[1]);\r\n //TimeSpan StarttimeSpan = TimeSpan.ParseExact(GetValueStr(ConName+\".Report_NWWStart_String\"), \"HH:mm\", CultureInfo.InvariantCulture);\r\n //TimeSpan EndtimeSpan = TimeSpan.ParseExact(GetValueStr(ConName+\".Report_NWWEnd_String\"), \"HH:mm\", CultureInfo.InvariantCulture);\r\n }\r\n buffer = Sminutes;\t \r\n Stream.Tag.SetValueNum(ConName+\".Set_NWWStart_Command_Min\",buffer);\r\n buffer = Eminutes;\t \r\n Stream.Tag.SetValueNum(ConName+\".Set_NWWEnd_Command_Min\",buffer);\r\n buffer = Shours;\t \r\n Stream.Tag.SetValueNum(ConName+\".Set_NWWStart_Command_Hour\",buffer);\r\n buffer = Ehours;\t \r\n Stream.Tag.SetValueNum(ConName+\".Set_NWWEnd_Command_Hour\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".REPORT_EventDelay_Sec\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SET_EventDelay_Sec\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".REPORT_EventDelay_Min\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SET_EventDelay_Min\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".REPORT_EventDelay_Hour\");\t\r\n Stream.Tag.SetValueNum(ConName+\".SET_EventDelay_Hour\",buffer);\r\nbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_NWWStart_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_NWWStart_Command\",buffer);\r\n buffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_NWWEnd_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_NWWEnd_Command\",buffer);\r\n\r\nStream.Tag.SetValueNum(\".tests\",2);\r\n\r\nfor (int i = 1; i <= 10; i++)\r\n      {                       \r\n         string indexj = i.ToString();\r\n\t\r\n\t\t\t\t bufferMin = (int)Stream.Tag.GetValueNum(ConName+\".REPORT_StartTime_Min\"+indexj);\r\n\t\t\t\t Stream.Tag.SetValueNum(ConName+\".SET_StartTime_Min\"+indexj ,bufferMin);\r\n\t\t\t\t\r\n\t\t\t\t bufferHour = (int)Stream.Tag.GetValueNum(ConName+\".REPORT_StartTime_Hour\"+indexj);\r\n\t\t\t\t Stream.Tag.SetValueNum(ConName+\".SET_StartTime_Hour\"+indexj ,bufferHour);\r\n\r\n\t\t\t\t bufferMin = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_StartTime\"+indexj+\"_Status\");\r\n\t\t\t\t Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_StartTime\"+indexj+\"_Command\" ,bufferMin);\r\n\t\t\t\t\r\n\t\t\t\tif (GetValueNum(\"Botton.TimeFormat\")==1)\r\n\t\t\t\t{\r\n\t\t\t\t\t\tswitch (GetValueStr(ConName+\".Report_Scedule_meridian_StartTime_\"+indexj))\r\n\t\t\t\t\t{\r\n    \t\t\t\t\tcase \"AM\":\r\n       \t\t\t\t \tSetValueNum(ConName+\".Scedule_meridian_StartTime_\"+indexj,0);\r\n       \t\t\t\t break;\r\n    \t\t\t\t  case \"PM\":\r\n       \t\t\t\t\tSetValueNum(ConName+\".Scedule_meridian_StartTime_\"+indexj,1);\r\n      \t\t\t\t  break;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n  \r\nfor (int i = 1; i <= 64; i++)\r\n      {                       \r\n         string indexj = i.ToString();\r\n\t\t\r\n\t\t\t\t bufferType = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramEventRuntimeData_EventType_Status_\"+indexj);\r\n\t\t\t\t Stream.Tag.SetValueNum(ConName+\".SetControllerProgramEventRuntimeData_EventType_Command_\"+indexj ,bufferType);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t bufferID = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramEventRuntimeData_EventId_Status_\"+indexj);\r\n\t\t\t\t Stream.Tag.SetValueNum(ConName+\".SetControllerProgramEventRuntimeData_EventId_Command_\"+indexj ,bufferID);\r\n\r\n\t\t\t\tstring timeString=GetValueStr(ConName+\".EventRunTime_String_\"+indexj);\r\n\t\t\t\tif (timeString != null)\r\n\t\t\t\t{\r\n\t\t\t\t\tstring[] timeComponents = timeString.Split(':');\r\n\t\t\t\t\t//TimeSpan RuntimeSpan = TimeSpan.TryParseExact(GetValueStr(ConName+\".EventRunTime_String_\"+indexj), \"hh\\\\:mm\\\\:ss\", CultureInfo.InvariantCulture);\r\n\t\t\t\t\tint hours = int.Parse(timeComponents[0]);\r\n\t\t\t\t\tint minutes = int.Parse(timeComponents[1]);\r\n\t\t\t\t\tint seconds = int.Parse(timeComponents[2]);\r\n\r\n\t\t\t\t bufferTime = hours;\r\n\t\t\t\t Stream.Tag.SetValueNum(ConName+\".Set_EventRunTime_Hour_\"+indexj ,bufferTime);\r\n\t\t\t\t bufferTime = minutes;\r\n\t\t\t\t Stream.Tag.SetValueNum(ConName+\".Set_EventRunTime_Min_\"+indexj ,bufferTime);\r\n\t\t\t\t bufferTime = seconds;\r\n\t\t\t\t Stream.Tag.SetValueNum(ConName+\".Set_EventRunTime_Sec_\"+indexj ,bufferTime);\r\n\t\t\t\t}\r\n  \t\t}\r\n\r\nfor (int i = 1; i <= 7; i++)\r\n{\r\nstring indexj = i.ToString();\r\nbufferBitMap = (int)Stream.Tag.GetValueNum(ConName+\".Report_DOWDays_Status_\"+indexj);\t\r\n Stream.Tag.SetValueNum(ConName+\".Set_DOWDays_Command_\"+indexj,bufferBitMap);\r\n\r\nbufferBitMap1 = (int)Stream.Tag.GetValueNum(ConName+\".Report_IntervalDays_Status_\"+indexj);\t\r\n Stream.Tag.SetValueNum(ConName+\".Set_IntervalDays_Command_\"+indexj,bufferBitMap1);\r\n\r\nbufferBitMap2 = (int)Stream.Tag.GetValueNum(ConName+\".Report_OddEvenDays_Status_\"+indexj);\t\r\n Stream.Tag.SetValueNum(ConName+\".Set_OddEvenDays_Command_\"+indexj,bufferBitMap2);\r\n}\r\nbufferBitMap2 = (int)Stream.Tag.GetValueNum(ConName+\".Report_OddEvenDays_Status_8\");\t\r\n Stream.Tag.SetValueNum(ConName+\".Set_OddEvenDays_Command_8\",bufferBitMap2);\r\nbufferBitMap2 = (int)Stream.Tag.GetValueNum(ConName+\".Report_OddEvenDays_Status_9\");\t\r\n Stream.Tag.SetValueNum(ConName+\".Set_OddEvenDays_Command_9\",bufferBitMap2);\r\nbufferBitMap2 = (int)Stream.Tag.GetValueNum(ConName+\".Report_OddEvenDays_Status_10\");\t\r\n Stream.Tag.SetValueNum(ConName+\".Set_OddEvenDays_Command_10\",bufferBitMap2);\r\n\r\n\r\nbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_DOWDays_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_DOWDays_Command\",buffer);\r\nbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_IntervalDays_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_IntervalDays_Command\",buffer);\r\nbuffer = (int)Stream.Tag.GetValueNum(ConName+\".ReportControllerProgramHeaderData_OddEvenDays_Status\");\t \r\n Stream.Tag.SetValueNum(ConName+\".SetControllerProgramHeaderData_OddEvenDays_Command\",buffer);\r\n\r\n\r\n Stream.Tag.SetValueNum(\"Script.Schedule_Edit_Copy\",0);\r\n\r\n}\r\n\r\n\r\n\r\n//======================================================================================================ICC2=========================================================================================================\r\n\r\n//--------------------------------------------------------------------------------------------------- Controller Info ICC2 -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.ControllerInfoCopyEnable_ICC2\")==1)\r\n {\r\n \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportControllerGlobals_YYYY_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetControllerGlobals_YYYY_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportControllerGlobals_MM_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetControllerGlobals_MM_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportControllerGlobals_DD_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetControllerGlobals_DD_Command\",buffer);\r\n\tif (GetValueNum(\"Botton.TimeFormat\")==0)\r\n\t{\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportControllerGlobals_Hours_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetControllerGlobals_Hours_Command\",buffer);\r\n\t}\r\n\telse\r\n  {\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportControllerGlobals_Hours_Status\")% 12;\t\r\n\tStream.Tag.SetValueNum(ConName+\".SetControllerTimeAndDate_12Hour_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConName+\".Report_ControlInfo_meridian\");\r\n  Stream.Tag.SetValueNum(ConName+\".ControlInfo_meridian\",buffer);\t\r\n\t}\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportControllerGlobals_Minutes_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetControllerGlobals_Minutes_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportControllerGlobals_GblSeasAdj_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetControllerGlobals_GblSeasAdj_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportControllerGlobals_ClikDelaySetting_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetControllerGlobals_ClikDelaySetting_Command\",buffer);\r\n\r\n\tSetValueNum(\"Script.ControllerInfoCopyEnable_ICC2\",0);\r\n }\r\n\r\n//--------------------------------------------------------------------------------------------------- Seasonal Adjust ICC2-----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.SeasonalAdjustCopyEnable_ICC2\")==1)\r\n {\r\n  \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportControllerGlobals_GblSeasAdj_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetGlobalSeasonalAdjust_GblSeasAdj_Command\",buffer);\r\n\t\r\n\r\n\tSetValueNum(\"Script.SeasonalAdjustCopyEnable_ICC2\",0);\r\n }\r\n\r\n//--------------------------------------------------------------------------------------------------- Solar Sync ICC2 -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.SolaeSyncCopyEnable_ICC2\")==1)\r\n {\r\n \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportSolarSyncEtData_Region_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetSolarSyncSettings_GeoRegion_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportSolarSyncEtData_Adjust_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetSolarSyncSettings_Adjust_Command\",buffer);\r\n\t\r\n\t\r\n\tSetValueNum(\"Script.SolaeSyncCopyEnable_ICC2\",0);\r\n }\r\n\r\n\r\n//---------------------------------------------------------------------------------------------------High Flow ICC2 -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.HighFlowCopyEnable_ICC2\")==1)\r\n {\r\n  buffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportFlowSetupParameters_Units_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".ConfigureFlowSetupParameters_Units_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportHighFlowShutdownParameters_HighPercentage_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetHighFlowShutdownParameters_HighPercentage_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportHighFlowShutdownParameters_AlarmDelay_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetHighFlowShutdownParameters_AlarmDelay_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportHighFlowShutdownParameters_AlarmThreshold_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetHighFlowShutdownParameters_AlarmThreshold_Command\",buffer);\r\n\t\r\n\t\r\n\tSetValueNum(\"Script.HighFlowCopyEnable_ICC2\",0);\r\n }\r\n\r\n//--------------------------------------------------------------------------------------------------Sensor Setting ICC2 -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.SensorSettingCopyEnable_ICC2\")==1)\r\n {\r\n  bufferstr = Stream.Tag.GetValueStr(ConNameICC2+\".ReportSensorModel_String\");\r\n  Stream.Tag.SetValueStr(ConNameICC2+\".SensorModel_String\",bufferstr);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportFlowSetupParameters_Units_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".ConfigureFlowSetupParameters_Units_Command\",buffer);\r\n\tbuffer = Stream.Tag.GetValueNum(ConNameICC2+\".ReportFlowSetupParameters_KFactor_Status\")/100;\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".ConfigureFlowSetupParameters_KFactor_Memory\",buffer);\r\n\tbuffer = Stream.Tag.GetValueNum(ConNameICC2+\".ReportFlowSetupParameters_Offset_Status\")/100;\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".ConfigureFlowSetupParameters_Offset_Memory\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportFlowSetupParameters_Pulses_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".ConfigureFlowSetupParameters_Pulses_Command\",buffer);\r\n\t \r\n\tSetValueNum(\"Script.SensorSettingCopyEnable_ICC2\",0);\r\n }\r\n//--------------------------------------------------------------------------------------------------Station Setting ICC2 -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.SensorSettingCopyEnable_ICC2\")==1)\r\n {\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportStationParameters_StationNumber_Command\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetStationParameters_StationNumber_Command\",buffer);\r\n\tbuffer = Stream.Tag.GetValueNum(ConNameICC2+\".ReportStationParameters_CycleTime_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetStationParameters_CycleTime_Command\",buffer);\r\n\tbuffer = Stream.Tag.GetValueNum(ConNameICC2+\".ReportStationParameters_SoakTime_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetStationParameters_SoakTime_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameICC2+\".ReportStationParameters_Pump1Usage_Status\");\r\n  Stream.Tag.SetValueNum(ConNameICC2+\".SetStationParameters_Pump1Usage_Command\",buffer);\r\n\t \r\n\tSetValueNum(\"Script.SensorSettingCopyEnable_ICC2\",0);\r\n }\r\n//======================================================================================================ACC1=========================================================================================================\r\n#region \"ACC1\"\r\n   \r\n//--------------------------------------------------------------------------------------------------- Controller Info  -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.ControllerInfoCopyEnable_ACC1\")==1)\r\n {\r\n \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_YYYY_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_YYYY_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_MM_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_MM_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_DD_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_DD_Command\",buffer);\r\n\tif (GetValueNum(\"Botton.TimeFormat\")==0)\r\n\t{\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_Hours_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_Hours_Command\",buffer);\r\n\t}\r\n\telse\r\n\t{\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_Hours_Status\") % 12;\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerTimeAndDate_12Hour_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".Report_ControlInfo_meridian\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".ControlInfo_meridian\",buffer);\t\r\n\t}\t\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_Minutes_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_Minutes_Command\",buffer);\r\n\t\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_SysDcHour_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_SysDcHour_Command\",buffer);\r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_FcpDcHour_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_FcpDcHour_Command\",buffer); \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_Options_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_Options_Command\",buffer); \r\n\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_CurEtap_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_CurEtap_Command\",buffer); \r\n\r\n  buffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_MaxEtap_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_MaxEtap_Command\",buffer); \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_Response_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_Response_Command\",buffer); \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_ReportInterval_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_ReportInterval_Command\",buffer);  \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_OptStatus_Status\");//----\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_OptStatus_Command\",buffer);  \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_OffStatus_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_OffStatus_Command\",buffer);  \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_GblSeasAdj_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_GblSeasAdj_Command\",buffer);  \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_StackMode_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_StackMode_Command\",buffer);  \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_SsPrgThold_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_SsPrgThold_Command\",buffer);  \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_SsgSsPrgThold_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetControllerGlobals_SsgSsPrgThold_Command\",buffer);  \r\n\t  \r\n\t  \r\n\tSetValueNum(\"Script.ControllerInfoCopyEnable_ACC1\",0);\r\n }\r\n\r\n\r\n\r\n\r\n\r\n//--------------------------------------------------------------------------------------------------- Solar Sync ACC1 -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.SolarSyncCopyEnable_ACC1\")==1)\r\n {\r\n \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportSolarSyncSettings_GeoRegion_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".ConfigureSolarSyncSettings_GeoRegion_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportSolarSyncSettings_Adjust_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".ConfigureSolarSyncSettings_Adjust_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportSolarSyncETData_DelayDays_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetSolarSyncDelaySettings_DelayDays_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportSolarSyncETData_DelayAdj_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetSolarSyncDelaySettings_DelayAdjust_Command\",buffer);\r\n\t\r\n\tSetValueNum(\"Script.SolarSyncCopyEnable_ACC1\",0);\r\n }\r\n\r\n\r\n//--------------------------------------------------------------------------------------------------- Station Paramter ACC1 -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.StationParamterCopyEnable_ACC1\")==1)\r\n {\r\n\t int min , hour;\r\n\t \r\n \tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportStationParameters_StationID_ACC1\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_StationID_Command\",buffer);\r\n\t bufferstr=Stream.Tag.GetValueStr(ConNameACC1+\".ReportStationParameters_StationName_Status\");\r\n\t Stream.Tag.SetValueStr(ConNameACC1+\".SetStationParameters_StationName_Command\",bufferstr);\r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportStationParameters_CycleTime_Status\");\r\n\t hour= (int)buffer/60;\r\n\t min=(int)buffer%60;\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_CycleTime_Hour_Command\",hour);\r\n\tStream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_CycleTime_Min_Command\",min); \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportStationParameters_SoakTime_Status\");\r\n\t hour= (int)buffer/60;\r\n\t min=(int)buffer%60;\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_SoakTime_Hour_Command\",hour);\r\n\tStream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_SoakTime_Min_Command\",min); \r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportStationParameters_FlowZone_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_FlowZone_Command\",buffer);\r\n\t \r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportStationParameters_MaxPercentOverflow_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_MaxPercentOverflow_Command\",buffer); \r\n\t \r\n  if (GetValueNum(ConNameACC1+\".ReportStationParameters_LearnedFlow_Status\")==65535)\r\n\t{\r\n  //Stream.Tag.SetValueNum(ConName+\".SetStationParameters_LearnedFlow_Command\",6553.5);\r\n\t\tStream.Tag.SetValueNum(ConName+\".SetStationParameters_LearnedFlow_United\",6553.5);\r\n\t}\r\n else\r\n\t{\r\n  buffer = (Stream.Tag.GetValueNum(ConNameACC1+\".ReportStationParameters_LearnedFlow_Status\")/10) * (GetValueNum(\"Botton.UnitScaleGPM\"));\r\n\t\t//File.AppendAllText(@\"C:\\Users\\ahmed\\OneDrive - streamcontrols.com\\Desktop\\Work\\Hunter\\HunterApp\\H360\\flowpram.txt\",\"without :\"+buffer.ToString()+Environment.NewLine);\r\n\t\tbuffer=  Math.Round(buffer, 1);\r\n\t\t//File.AppendAllText(@\"C:\\Users\\ahmed\\OneDrive - streamcontrols.com\\Desktop\\Work\\Hunter\\HunterApp\\H360\\flowpram.txt\",buffer.ToString()+Environment.NewLine);\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_LearnedFlow_United\",buffer);\r\n\t}\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportStationParameters_FlowDelay_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_FlowDelay_Command\",buffer);\r\n\tbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportStationParameters_FlowPriority_Status\");\r\n  Stream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_FlowPriority_Command\",buffer);\r\n\tfor (int i=1 ; i<=6 ; i++)\r\n\t{\r\n\t string index = i.ToString();\r\n\t Pumpbuffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportStationParameters_Pump\"+index+\"Usage_Status\");\r\n   Stream.Tag.SetValueNum(ConNameACC1+\".SetStationParameters_Pump\"+index+\"Usage_Command\",Pumpbuffer);\r\n\t}\r\n\r\n\tSetValueNum(\"Script.StationParamterCopyEnable_ACC1\",0);\r\n }\r\n\r\n\r\n//--------------------------------------------------------------------------------------------------- Seasonal Adj ACC1 -----------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Script.SeasonalAdjustCopyEnable_ACC1\")==1)\r\n {\r\n\t buffer = (int)Stream.Tag.GetValueNum(ConNameACC1+\".ReportControllerGlobals_GblSeasAdj_Status\");\r\n   Stream.Tag.SetValueNum(ConNameACC1+\".SetGlobalSeasonalAdjust_GblSeasAdj_Command\",buffer);\r\n\t \r\n\t SetValueNum(\"Script.SeasonalAdjustCopyEnable_ACC1\",0);\r\n }\r\n\r\n#endregion\r\n\r\n","IsCylic":true,"IsEvent":false,"Cyclic_timer":1000,"IsValidated":false,"IsScriptEnabled":true,"IsRunOnceAtStartup":false,"EnableTag":"","DllFolderPath":"C:\\Users\\ahmed\\OneDrive - streamcontrols.com\\Desktop\\Work\\Hunter\\HunterApp\\Scripts\\Dlls\\","strReferencePaths_csv":"","IncludeReferencesUnderScripts_Ref_Folder":false,"RunScriptInStandbyMode":false,"Data_3":null,"Data_4":null,"Data_5":null,"Data_6":null,"ver":"4.18.9.7","last_save":"2025-04-30 02:04:35"}