{"Type":null,"Title":"Email","Script_Code":"//CSharp code\r\n\r\nif (GetValueNum(\"C001.Shutdown_is_Active\") == 0)\r\n{\r\nStream.Tag.SetValueNum(\"Email.Sent\",0);\r\n}\r\n\r\n\r\nif (GetValueNum(\"Email.Sent\") == 0 && GetValueNum(\"C001.Shutdown_is_Active\") == 1)\r\n{\r\n\t\r\n\t\r\n\tvar Host=\"smtp.gmail.com\";\r\n\tvar Port=\"587\";\r\n\tvar UserName=\"stream.Egypt.demo@gmail.com\";\r\n\tvar Password=\"Hunter@10\";\r\n\tvar EnableSsl=true;\r\n\tvar From=\"stream.Egypt.demo@gmail.com\";\r\n\t//var Recipients=\"stream.Egypt.demo@gmail.com;eng.adel.a@gmail.com\";\r\n  var Recipients=\"eng.adel.a@gmail.com\";\r\n\tif (Stream.Tag.GetValueStr(\"Email.To\")!= \"\")\r\n{\r\n\tRecipients=GetValueStr(\"Email.To\");\r\n}\r\n\tvar Subject=\"Alarm Notification\";\r\n\t\r\n\t\r\n\t//Formatted Body\t\r\n\tStringBuilder sb = new StringBuilder();\r\n\tstring html = $\"<p>Shutdown Alarm,</p><p></p><p>This Alert from Stream Irrigation.</p><p>Location: il monte galala sokhna </p><p>Description: Irrigation controller C001 Shutdown is Active</p><p>Time: {DateTime.Now}</p><p>Severity: Critical</p>\";\r\n\tsb.AppendLine(html);\r\n\r\n\t\r\n  var Body = sb.ToString();\r\n\r\n\tStream.Mail.SendEmail(Host,Port,UserName,Password,EnableSsl,From,Recipients,Subject,Body,true);\r\n\r\n  Stream.Tag.SetValueNum(\"Email.Sent\",1);\r\n}","IsCylic":true,"IsEvent":false,"Cyclic_timer":1000,"IsValidated":false,"IsScriptEnabled":false,"IsRunOnceAtStartup":false,"EnableTag":"","DllFolderPath":"C:\\Users\\ahmed\\OneDrive\\Desktop\\Work\\Hunter\\App v2.0\\Scripts\\Dlls\\","strReferencePaths_csv":"","IncludeReferencesUnderScripts_Ref_Folder":false,"RunScriptInStandbyMode":false,"Data_3":null,"Data_4":null,"Data_5":null,"Data_6":null,"ver":"4.17.20.12","last_save":"2024-03-20 00:03:22"}