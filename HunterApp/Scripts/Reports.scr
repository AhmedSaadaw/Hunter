{"Type":null,"Title":"Reports","Script_Code":"using System.Diagnostics;\r\nusing System.IO;\r\nusing System;\r\nusing System.Threading.Tasks;\r\n\r\n\r\npublic string AllTags=\",\";\r\npublic string AllTags2=\",\";\r\npublic string tags;\r\nvar Date = DateTime.Now ;\r\nstring ToDay = Date.ToString(\"yyyy-MM-dd\");\r\n\r\nstring ConName = GetValueStr(\"Script.MapControllerName\");\r\nstring ConName_ICC2 = GetValueStr(\"Script.MapControllerNameICC2\");\r\nstring ConName_ACC1 = GetValueStr(\"Script.MapControllerNameACC1\");\r\nif (GetValueNum(\"Script.ReportCounter\")==0)\r\n\t{\r\n\t\tSetValueNum(\"Script.ReportCounter\",1);\r\n\t}\r\n\r\nif (Date.Hour==7 && Date.Minute==1)\r\n{\r\nawait Writetxt();\r\n}\r\n//------------------------------------------------------------------------------------------------------------- Block -------------------------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Botton.BlockReport\")==1)\r\n{\r\nSetValueNum(\"Script.EnableReport\",0);\r\n\t\t\r\nstring path=Stream.Application.GetAppPath()+@\"\\Reports\\ReportText\\\"+ ConName +\"_Block.txt\";\r\n// List of type string\r\nList<string> list = new List<string>{ConName+\".ReportBlockParameters_BlockStn1_Status\",ConName+\".ReportBlockParameters_BlockStn2_Status\",ConName+\".ReportBlockParameters_BlockStn3_Status\",ConName+\".ReportBlockParameters_BlockStn4_Status\",ConName+\".ReportBlockParameters_BlockStn5_Status\",ConName+\".ReportBlockParameters_BlockStn6_Status\",ConName+\".ReportBlockParameters_BlockStn7_Status\",ConName+\".ReportBlockParameters_BlockStn8_Status\"};\r\nawait Generatetxt (path,ConName+\".ReportBlockParameters_Trigger\",(int)GetValueNum(\"Botton.BockReportNum\"),ConName+\".ReportBlockParameters_BlockNumber_Command\",list);\r\n\r\nstring programName = Stream.Application.GetAppPath()+@\"\\Reports\\Block.xlsm\";\r\n\r\n            // Create a new process object\r\n            Process program = new Process();\r\n\r\n            // Set the file name to the program name\r\n            program.StartInfo.FileName = programName;\r\n\r\n            // Start the process\r\n            program.Start();\r\n\r\n\r\nSetValueNum(\"Botton.BlockReport\",0);\r\n}\r\n//------------------------------------------------------------------------------------------------------------ Schedule -------------------------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Botton.ScheduleReport\")==1)\r\n{\r\n\tSetValueNum(\"Script.EnableReport\",0);\r\n\t\r\n\tstring count = GetValueNum(\"Script.ReportCounter\").ToString();\r\nstring path=Stream.Application.GetAppPath()+@\"\\Reports\\ReportText\\\"+ ConName +\"_Schedule.txt\";\r\nstring path2=Stream.Application.GetAppPath()+@\"\\Reports\\ReportText\\\"+ ConName +\"_Schedule2.txt\";\t\r\n// List of type string\r\nList<string> listtags = new List<string>();\r\nList<string> listtags2 = new List<string>();\r\nList<Tag> list = new List<Tag>();\r\nlist =Stream.Application.GetTags();\r\nforeach(Tag t in list)\r\n{if (t.Name.StartsWith(ConName))\r\n {\t\r\n\tif((t.Name.Contains(\"ReportControllerProgramHeaderData\"))|| (t.Name.Contains(\"Report_NWWStart\"))|| (t.Name.Contains(\"REPORT_EventDelay\")) || (t.Name.Contains(\"REPORT_StartTime\")) || (t.Name.Contains(\"EventRunTime_String\")) || (t.Name.Contains(\"ReportControllerProgramEventRuntimeData\")) || (t.Name.Contains(\"SeasonalAdjust_String\")) )\r\n\t{\r\n\t \tlisttags.Add(t.Name);\r\n\t}\r\n\t else if (t.Name.Contains(\"Report_NWWEnd\"))\r\n\t {\r\n\t\t listtags2.Add(t.Name);\r\n\t }\r\n }\r\n}\r\n/*\twhile (GetValueNum(\"Script.ReportCounter\")<=GetValueNum(\"Botton.ScheduleReportNum\"))\t\r\n\t{ \r\nawait Generatetxt3 (path,ConName+\".ReportControllerProgramHeaderData_Trigger\",(int)GetValueNum(\"Botton.ScheduleReportNum\"),ConName+\".ReportControllerProgramHeaderData_ProgramNumber_Command\",listtags,ConName+\".ReportControllerProgramEventRuntimeData_Trigger\");\r\n\t\tSetValueNum(\"Script.ReportCounter\",GetValueNum(\"Script.ReportCounter\")+1);\r\n\t}\r\n*/\r\n\tawait Generatetxt2 (path,path2,ConName+\".ReportControllerProgramHeaderData_Trigger\",(int)GetValueNum(\"Botton.ScheduleReportNum\"),ConName+\".ReportControllerProgramHeaderData_ProgramNumber_Command\",listtags,listtags2,ConName+\".ReportControllerProgramEventRuntimeData_Trigger\");\r\n\t\r\nstring programName = Stream.Application.GetAppPath()+@\"\\Reports\\Schedule.xlsm\";\r\n\r\n            // Create a new process object\r\n            Process program = new Process();\r\n\r\n            // Set the file name to the program name\r\n            program.StartInfo.FileName = programName;\r\n\r\n            // Start the process\r\n            program.Start();\r\n\r\n\r\nSetValueNum(\"Botton.ScheduleReport\",0);\r\n}\r\n//------------------------------------------------------------------------------------------------------------- Device Name --------------------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Botton.DeviceInfoReport\")==1)\r\n{\r\n\tSetValueNum(\"Script.EnableReport\",0);\r\nstring path=Stream.Application.GetAppPath()+@\"\\Reports\\ReportText\\C001_DeviceInfo.txt\";\r\n// List of type string\r\nList<string> list = new List<string>{ConName+\".GetItemInformation_ItemID_Command\",ConName+\".GetItemInformation_ItemType_String\",ConName+\".GetItemInformation_ItemID_Status\",ConName+\".GetItemInformation_LoadPresent_Status\",ConName+\".GetItemInformation_TurnOnCurrent_Status\",ConName+\".GetItemInformation_Comm_Status\"};\r\nint DeviceSelected =(int)GetValueNum(ConName+\".GetItemInformation_DeviceSelected\");\r\nSetValueNum(ConName+\".GetItemInformation_ItemType_Command\",DeviceSelected);\r\nawait Generatetxt (path,ConName+\".GetItemInformation_Trigger\",(int)GetValueNum(\"Botton.DeviceInfoReportNum\"),ConName+\".GetItemInformation_ItemID_Command\",list);\r\n\r\n string programName = Stream.Application.GetAppPath()+@\"\\Reports\\Device Info.xlsm\";\r\n\r\n            // Create a new process object\r\n            Process program = new Process();\r\n\r\n            // Set the file name to the program name\r\n            program.StartInfo.FileName = programName;\r\n\r\n            // Start the process\r\n            program.Start();\r\n\r\n            // Wait for the process to exit\r\n           // program.WaitForExit();\r\n\r\n\r\nSetValueNum(\"Botton.DeviceInfoReport\",0);\r\n}\r\n\r\n//--------------------------------------------------------------------------------------------Flow Total-------------------------------------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Botton.FlowTotalReport\")==1)\r\n{\r\n\tSetValueNum(\"Script.EnableReport\",0);\r\n\t// Specify the path to the executable\r\nawait Writetxt();\r\nstring programPath = Stream.Application.GetAppPath()+@\"\\Reports\\Flow Total.xlsm\";\r\n\r\n// Start the program\r\nProcess.Start(programPath);\r\n\r\n\tSetValueNum(\"Botton.FlowTotalReport\",0);\r\n}\r\n\r\n//--------------------------------------------------------------------------------------------Flow Total ICC2---------------------------------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Botton.FlowTotalReport_ICC2\")==1)\r\n{\r\n\tSetValueNum(\"Script.EnableReport\",0);\r\n\t// Specify the path to the executable\r\nawait WritetxtICC2();\r\nstring programPath = Stream.Application.GetAppPath()+@\"\\Reports\\Flow Total ICC2.xlsm\";\r\n\r\n// Start the program\r\nProcess.Start(programPath);\r\n\r\n\tSetValueNum(\"Botton.FlowTotalReport_ICC2\",0);\r\n}\r\n//--------------------------------------------------------------------------------------------Flow Total ACC1---------------------------------------------------------------------------------------------------------------\r\nif (GetValueNum(\"Botton.FlowTotalReport_ACC1\")==1)\r\n{\r\n\tSetValueNum(\"Script.EnableReport\",0);\r\n\t// Specify the path to the executable\r\nawait WritetxtACC1();\r\nstring programPath = Stream.Application.GetAppPath()+@\"\\Reports\\Flow Total ACC1.xlsm\";\r\n\r\n// Start the program\r\nProcess.Start(programPath);\r\n\r\n\tSetValueNum(\"Botton.FlowTotalReport_ACC1\",0);\r\n}\r\n\r\n\r\n//--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\npublic async Task Writetxt ()\r\n{\r\n\tstring path = Stream.Application.GetAppPath()+@\"\\Reports\\ReportText\\\"+ ConName +\"_ContFlow_\"+ ToDay +\".txt\";\r\n\tStream.FileSystem.WriteTagsToFileCSV(path,ConName+\".ReportFlowTotals_ContTot_Status_Day1,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day2,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day3,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day4,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day5,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day6,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day7,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day8,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day9,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day10,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day11,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day12,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day13,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day14,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day15,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day16,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day17,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day18,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day19,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day20,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day21,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day22,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day23,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day24,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day25,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day26,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day27,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day28,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day29,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day30,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day31,\"+ConName+\".ReportFlowTotals_Text_Status_Day1,\"+ConName+\".ReportFlowTotals_Text_Status_Day2,\"+ConName+\".ReportFlowTotals_Text_Status_Day3,\"+ConName+\".ReportFlowTotals_Text_Status_Day4,\"+ConName+\".ReportFlowTotals_Text_Status_Day5,\"+ConName+\".ReportFlowTotals_Text_Status_Day6,\"+ConName+\".ReportFlowTotals_Text_Status_Day7,\"+ConName+\".ReportFlowTotals_Text_Status_Day8,\"+ConName+\".ReportFlowTotals_Text_Status_Day9,\"+ConName+\".ReportFlowTotals_Text_Status_Day10,\"+ConName+\".ReportFlowTotals_Text_Status_Day11,\"+ConName+\".ReportFlowTotals_Text_Status_Day12,\"+ConName+\".ReportFlowTotals_Text_Status_Day13,\"+ConName+\".ReportFlowTotals_Text_Status_Day14,\"+ConName+\".ReportFlowTotals_Text_Status_Day15,\"+ConName+\".ReportFlowTotals_Text_Status_Day16,\"+ConName+\".ReportFlowTotals_Text_Status_Day17,\"+ConName+\".ReportFlowTotals_Text_Status_Day18,\"+ConName+\".ReportFlowTotals_Text_Status_Day19,\"+ConName+\".ReportFlowTotals_Text_Status_Day20,\"+ConName+\".ReportFlowTotals_Text_Status_Day21,\"+ConName+\".ReportFlowTotals_Text_Status_Day22,\"+ConName+\".ReportFlowTotals_Text_Status_Day23,\"+ConName+\".ReportFlowTotals_Text_Status_Day24,\"+ConName+\".ReportFlowTotals_Text_Status_Day25,\"+ConName+\".ReportFlowTotals_Text_Status_Day26,\"+ConName+\".ReportFlowTotals_Text_Status_Day27,\"+ConName+\".ReportFlowTotals_Text_Status_Day28,\"+ConName+\".ReportFlowTotals_Text_Status_Day29,\"+ConName+\".ReportFlowTotals_Text_Status_Day30,\"+ConName+\".ReportFlowTotals_Text_Status_Day31,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month1,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month2,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month3,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month4,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month5,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month6,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month7,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month8,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month9,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month10,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month11,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month12,\"+ConName+\".ReportFlowTotals_Text_Status_Month1,\"+ConName+\".ReportFlowTotals_Text_Status_Month2,\"+ConName+\".ReportFlowTotals_Text_Status_Month3,\"+ConName+\".ReportFlowTotals_Text_Status_Month4,\"+ConName+\".ReportFlowTotals_Text_Status_Month5,\"+ConName+\".ReportFlowTotals_Text_Status_Month6,\"+ConName+\".ReportFlowTotals_Text_Status_Month7,\"+ConName+\".ReportFlowTotals_Text_Status_Month8,\"+ConName+\".ReportFlowTotals_Text_Status_Month9,\"+ConName+\".ReportFlowTotals_Text_Status_Month10,\"+ConName+\".ReportFlowTotals_Text_Status_Month11,\"+ConName+\".ReportFlowTotals_Text_Status_Month12,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year1,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year2,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year3,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year4,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year5,\"+ConName+\".ReportFlowTotals_Text_Status_Year1,\"+ConName+\".ReportFlowTotals_Text_Status_Year2,\"+ConName+\".ReportFlowTotals_Text_Status_Year3,\"+ConName+\".ReportFlowTotals_Text_Status_Year4,\"+ConName+\".ReportFlowTotals_Text_Status_Year5,\",false,false);\r\n\r\nfor (int i = 1; i <= 6; i++)\r\n   {    \r\n\t\tstring index = i.ToString();                   \r\n\t\t//string name= @\"\\+ ConName +\"_FlowSensor\"+index+\"_\"+ToDay+\".txt\";\r\n\t\tpath = Stream.Application.GetAppPath()+@\"\\Reports\\ReportText\\\"+ ConName +\"_FlowSensor\"+index+\"_\"+ ToDay +\".txt\";\r\n\t\t//path=Stream.Application.GetAppPath()+@\"\\Reports\\ReportText\"+name;\r\n   Stream.FileSystem.WriteTagsToFileCSV(path,ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day1,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day2,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day3,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day4,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day5,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day6,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day7,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day8,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day9,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day10,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day11,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day12,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day13,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day14,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day15,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day16,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day17,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day18,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day19,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day20,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day21,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day22,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day23,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day24,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day25,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day26,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day27,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day28,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day29,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day30,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Day31,\"+ConName+\".ReportFlowTotals_Text_Status_Day1,\"+ConName+\".ReportFlowTotals_Text_Status_Day2,\"+ConName+\".ReportFlowTotals_Text_Status_Day3,\"+ConName+\".ReportFlowTotals_Text_Status_Day4,\"+ConName+\".ReportFlowTotals_Text_Status_Day5,\"+ConName+\".ReportFlowTotals_Text_Status_Day6,\"+ConName+\".ReportFlowTotals_Text_Status_Day7,\"+ConName+\".ReportFlowTotals_Text_Status_Day8,\"+ConName+\".ReportFlowTotals_Text_Status_Day9,\"+ConName+\".ReportFlowTotals_Text_Status_Day10,\"+ConName+\".ReportFlowTotals_Text_Status_Day11,\"+ConName+\".ReportFlowTotals_Text_Status_Day12,\"+ConName+\".ReportFlowTotals_Text_Status_Day13,\"+ConName+\".ReportFlowTotals_Text_Status_Day14,\"+ConName+\".ReportFlowTotals_Text_Status_Day15,\"+ConName+\".ReportFlowTotals_Text_Status_Day16,\"+ConName+\".ReportFlowTotals_Text_Status_Day17,\"+ConName+\".ReportFlowTotals_Text_Status_Day18,\"+ConName+\".ReportFlowTotals_Text_Status_Day19,\"+ConName+\".ReportFlowTotals_Text_Status_Day20,\"+ConName+\".ReportFlowTotals_Text_Status_Day21,\"+ConName+\".ReportFlowTotals_Text_Status_Day22,\"+ConName+\".ReportFlowTotals_Text_Status_Day23,\"+ConName+\".ReportFlowTotals_Text_Status_Day24,\"+ConName+\".ReportFlowTotals_Text_Status_Day25,\"+ConName+\".ReportFlowTotals_Text_Status_Day26,\"+ConName+\".ReportFlowTotals_Text_Status_Day27,\"+ConName+\".ReportFlowTotals_Text_Status_Day28,\"+ConName+\".ReportFlowTotals_Text_Status_Day29,\"+ConName+\".ReportFlowTotals_Text_Status_Day30,\"+ConName+\".ReportFlowTotals_Text_Status_Day31,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month1,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month2,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month3,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month4,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month5,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month6,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month7,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month8,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month9,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month10,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month11,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Month12,\"+ConName+\".ReportFlowTotals_Text_Status_Month1,\"+ConName+\".ReportFlowTotals_Text_Status_Month2,\"+ConName+\".ReportFlowTotals_Text_Status_Month3,\"+ConName+\".ReportFlowTotals_Text_Status_Month4,\"+ConName+\".ReportFlowTotals_Text_Status_Month5,\"+ConName+\".ReportFlowTotals_Text_Status_Month6,\"+ConName+\".ReportFlowTotals_Text_Status_Month7,\"+ConName+\".ReportFlowTotals_Text_Status_Month8,\"+ConName+\".ReportFlowTotals_Text_Status_Month9,\"+ConName+\".ReportFlowTotals_Text_Status_Month10,\"+ConName+\".ReportFlowTotals_Text_Status_Month11,\"+ConName+\".ReportFlowTotals_Text_Status_Month12,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Year1,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Year2,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Year3,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Year4,\"+ConName+\".ReportFlowTotals_FlowSensor\"+index+\"_Status_Year5,\"+ConName+\".ReportFlowTotals_Text_Status_Year1,\"+ConName+\".ReportFlowTotals_Text_Status_Year2,\"+ConName+\".ReportFlowTotals_Text_Status_Year3,\"+ConName+\".ReportFlowTotals_Text_Status_Year4,\"+ConName+\".ReportFlowTotals_Text_Status_Year5,\",false,false);  \r\n   }\r\n}\r\n//block 64 , program 32 ,device item info (station 225)(sensor 10)(MV 6)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//---------------------------------------------------------------------------------------------------------------ICC2FowReport-------------------------------------------------------------------------------------\r\n\r\npublic async Task WritetxtICC2 ()\r\n{\r\n\tstring path = Stream.Application.GetAppPath()+@\"\\Reports\\ReportText\\\"+ ConName_ICC2 +\"_ICC2_\"+ ToDay +\".txt\";\r\n\tStream.FileSystem.WriteTagsToFileCSV(path,ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_1,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_2,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_3,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_4,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_5,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_6,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_7,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_8,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_9,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_10,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_11,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_12,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_13,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_14,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_15,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_16,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_17,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_18,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_19,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_20,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_21,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_22,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_23,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_24,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_25,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_26,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_27,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_28,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_29,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_30,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusDay_31,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_1,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_2,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_3,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_4,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_5,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_6,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_7,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_8,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_9,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_10,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_11,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_12,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_13,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_14,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_15,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_16,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_17,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_18,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_19,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_20,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_21,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_22,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_23,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_24,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_25,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_26,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_27,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_28,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_29,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_30,\"+ConName_ICC2+\".ReportFlowRates_Text_Status_31,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_1,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_2,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_3,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_4,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_5,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_6,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_7,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_8,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_9,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_10,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_11,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusMonth_12,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_1,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_2,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_3,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_4,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_5,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_6,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_7,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_8,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_9,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_10,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_11,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusMontth_12,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusYear_1,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusYear_2,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusYear_3,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusYear_4,\"+ConName_ICC2+\".ReportFlowTotals_FlowTotal_StatusYear_5,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusYear_1,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusYear_2,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusYear_3,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusYear_4,\"+ConName_ICC2+\".ReportFlowRates_Text_StatusYear_5,\",false,false);\r\n}\r\n\r\n\r\n//---------------------------------------------------------------------------------------------------------------ACC1FowReport-------------------------------------------------------------------------------------\r\n\r\npublic async Task WritetxtACC1 ()\r\n{\r\n\tstring path = Stream.Application.GetAppPath()+@\"\\Reports\\ReportText\\\"+ ConName_ACC1 +\"_ACC1_\"+ ToDay +\".txt\";\r\n\tStream.FileSystem.WriteTagsToFileCSV(path,ConName+\".ReportFlowTotals_ContTot_Status_Day1,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day2,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day3,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day4,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day5,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day6,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day7,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day8,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day9,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day10,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day11,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day12,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day13,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day14,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day15,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day16,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day17,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day18,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day19,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day20,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day21,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day22,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day23,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day24,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day25,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day26,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day27,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day28,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day29,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day30,\"+ConName+\".ReportFlowTotals_ContTot_Status_Day31,\"+ConName+\".ReportFlowTotals_Text_Status_Day1,\"+ConName+\".ReportFlowTotals_Text_Status_Day2,\"+ConName+\".ReportFlowTotals_Text_Status_Day3,\"+ConName+\".ReportFlowTotals_Text_Status_Day4,\"+ConName+\".ReportFlowTotals_Text_Status_Day5,\"+ConName+\".ReportFlowTotals_Text_Status_Day6,\"+ConName+\".ReportFlowTotals_Text_Status_Day7,\"+ConName+\".ReportFlowTotals_Text_Status_Day8,\"+ConName+\".ReportFlowTotals_Text_Status_Day9,\"+ConName+\".ReportFlowTotals_Text_Status_Day10,\"+ConName+\".ReportFlowTotals_Text_Status_Day11,\"+ConName+\".ReportFlowTotals_Text_Status_Day12,\"+ConName+\".ReportFlowTotals_Text_Status_Day13,\"+ConName+\".ReportFlowTotals_Text_Status_Day14,\"+ConName+\".ReportFlowTotals_Text_Status_Day15,\"+ConName+\".ReportFlowTotals_Text_Status_Day16,\"+ConName+\".ReportFlowTotals_Text_Status_Day17,\"+ConName+\".ReportFlowTotals_Text_Status_Day18,\"+ConName+\".ReportFlowTotals_Text_Status_Day19,\"+ConName+\".ReportFlowTotals_Text_Status_Day20,\"+ConName+\".ReportFlowTotals_Text_Status_Day21,\"+ConName+\".ReportFlowTotals_Text_Status_Day22,\"+ConName+\".ReportFlowTotals_Text_Status_Day23,\"+ConName+\".ReportFlowTotals_Text_Status_Day24,\"+ConName+\".ReportFlowTotals_Text_Status_Day25,\"+ConName+\".ReportFlowTotals_Text_Status_Day26,\"+ConName+\".ReportFlowTotals_Text_Status_Day27,\"+ConName+\".ReportFlowTotals_Text_Status_Day28,\"+ConName+\".ReportFlowTotals_Text_Status_Day29,\"+ConName+\".ReportFlowTotals_Text_Status_Day30,\"+ConName+\".ReportFlowTotals_Text_Status_Day31,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month1,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month2,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month3,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month4,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month5,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month6,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month7,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month8,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month9,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month10,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month11,\"+ConName+\".ReportFlowTotals_ContTot_Status_Month12,\"+ConName+\".ReportFlowTotals_Text_Status_Month1,\"+ConName+\".ReportFlowTotals_Text_Status_Month2,\"+ConName+\".ReportFlowTotals_Text_Status_Month3,\"+ConName+\".ReportFlowTotals_Text_Status_Month4,\"+ConName+\".ReportFlowTotals_Text_Status_Month5,\"+ConName+\".ReportFlowTotals_Text_Status_Month6,\"+ConName+\".ReportFlowTotals_Text_Status_Month7,\"+ConName+\".ReportFlowTotals_Text_Status_Month8,\"+ConName+\".ReportFlowTotals_Text_Status_Month9,\"+ConName+\".ReportFlowTotals_Text_Status_Month10,\"+ConName+\".ReportFlowTotals_Text_Status_Month11,\"+ConName+\".ReportFlowTotals_Text_Status_Month12,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year1,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year2,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year3,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year4,\"+ConName+\".ReportFlowTotals_ContTot_Status_Year5,\"+ConName+\".ReportFlowTotals_Text_Status_Year1,\"+ConName+\".ReportFlowTotals_Text_Status_Year2,\"+ConName+\".ReportFlowTotals_Text_Status_Year3,\"+ConName+\".ReportFlowTotals_Text_Status_Year4,\"+ConName+\".ReportFlowTotals_Text_Status_Year5,\",false,false);\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\npublic async Task Generatetxt (string Path,string TrigerGet,int IteratingNo,string Num,List<string> TagList,string SecondTrigerGet=null)\r\n{\r\n\r\n\r\n for (int i=1 ; i <= IteratingNo;i++)\r\n\t{\r\n\t\t\r\n\t\tSetValueNum(Num,i);\r\n\t\tawait Task.Delay (1000);\r\n\t\tSetValueNum(TrigerGet,1);\r\n\t\t//SetValueStr(\".test\",SecondTrigerGet);\r\n\t\tSetValueNum(SecondTrigerGet,1);\r\n\t\tawait Task.Delay (2000);\r\n\t\tSetValueNum(SecondTrigerGet,1);\r\n\t foreach ( string tag in TagList)\r\n\t\t{\r\n\t\t AllTags+=tag+\",\";\r\n\t\t}\r\n\t\tSetValueStr(\".test\",AllTags);\r\n\tif (i==1){Stream.FileSystem.WriteTagsToFileCSV(Path,AllTags,false,false);}\r\n\t else{ Stream.FileSystem.WriteTagsToFileCSV(Path,\",\"+AllTags,true,false);}\r\n\t\tAllTags=\"\";\r\n\t}\r\n\r\n}\r\n\r\n\r\npublic async Task Generatetxt2 (string Path,string Path2,string TrigerGet,int IteratingNo,string Num,List<string> TagList,List<string> TagList2,string SecondTrigerGet=null)\r\n{\r\n\r\n for (int i=1 ; i <= IteratingNo;i++)\r\n\t{\r\n\t\t\r\n\t\tSetValueNum(Num,i);\r\n\t\tawait Task.Delay (1000);\r\n\t\tSetValueNum(TrigerGet,1);\r\n\t\tawait Task.Delay (1000);\r\n\t\t//SetValueStr(\".test\",SecondTrigerGet);\r\n\t\tSetValueNum(SecondTrigerGet,1);\r\n\t\tawait Task.Delay (2000);\r\n\t\tSetValueNum(TrigerGet,1);\r\n\t\tawait Task.Delay (1000);\r\n\t\tSetValueNum(SecondTrigerGet,1);\r\n\t foreach ( string tag in TagList)\r\n\t\t{\r\n\t\t AllTags+=tag+\",\";\r\n\t\t}\r\n\t\t\r\n\t\tforeach ( string tag2 in TagList2)\r\n\t\t{\r\n\t\t AllTags2+=tag2+\",\";\r\n\t\t}\r\n\t\t\r\n\t\tSetValueStr(\".test\",AllTags2);\r\n\t\t//Stream.FileSystem.SaveTagsToFileJson(Path,AllTags);\r\n\t\t\r\n\t\tif (i==1)\r\n\t\t{\r\n\t\t\tStream.FileSystem.WriteTagsToFileCSV(Path,AllTags,false,false);\r\n\t\t\tStream.FileSystem.WriteTagsToFileCSV(Path2,AllTags2,false,false);\r\n\t\t}\r\n\t else\r\n\t\t{\r\n\t\t  Stream.FileSystem.WriteTagsToFileCSV(Path,\",\"+AllTags,true,false);\r\n\t\t\tStream.FileSystem.WriteTagsToFileCSV(Path2,\",\"+AllTags2,true,false);\r\n\t\t}\r\n\t\t\r\n\t\tAllTags=\"\";\r\n\t\tAllTags2=\"\";\r\n\t}\r\n\r\n}\r\n\r\n\r\npublic async Task Generatetxt3 (string Path,string TrigerGet,int IteratingNo,string Num,List<string> TagList,string SecondTrigerGet=null)\r\n{\r\n\r\n\r\n\r\n\tint i; \r\n\ti= (int)GetValueNum(\"Script.ReportCounter\");\r\n\t\t\r\n\t\tSetValueNum(Num,i);\r\n\t\tawait Task.Delay (500);\r\n\t\tSetValueNum(TrigerGet,1);\r\n\t\t//SetValueStr(\".test\",SecondTrigerGet);\r\n\t\tSetValueNum(SecondTrigerGet,1);\r\n\t\tawait Task.Delay (1000);\r\n\t\tSetValueNum(SecondTrigerGet,1);\r\n\t foreach ( string tag in TagList)\r\n\t\t{\r\n\t\t AllTags+=tag+\",\";\r\n\t\t}\r\n\t\tSetValueStr(\".test\",AllTags);\r\n\tif (i==1){Stream.FileSystem.WriteTagsToFileCSV(Path,AllTags,false,false);}\r\n\t else{ Stream.FileSystem.WriteTagsToFileCSV(Path,\",\"+AllTags,true,false);}\r\n\t\tAllTags=\"\";\r\n\t\t\r\n\t}\r\n\r\n\r\n\r\n/*\r\n\tif (GetValueNum(\"Script.ReportCounter\")>=GetValueNum(\"Botton.ScheduleReportNum\"))\r\n{\r\n\tSetValueNum(\"Script.ReportCounter\",1);\r\n\tSetValueNum(\"Script.EnableReport\",0);\r\n}\r\n*/\r\n\tSetValueNum(\"Script.EnableReport\",0);","IsCylic":true,"IsEvent":false,"Cyclic_timer":1000,"IsValidated":false,"IsScriptEnabled":true,"IsRunOnceAtStartup":false,"EnableTag":"Script.EnableReport","DllFolderPath":"C:\\Users\\ahmed\\OneDrive - streamcontrols.com\\Desktop\\Work\\Hunter\\HunterApp\\Scripts\\Dlls\\","strReferencePaths_csv":"","IncludeReferencesUnderScripts_Ref_Folder":false,"RunScriptInStandbyMode":false,"Data_3":null,"Data_4":null,"Data_5":null,"Data_6":null,"ver":"4.18.5.0","last_save":"2025-03-13 14:03:37"}